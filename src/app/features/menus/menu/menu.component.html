<app-card>
  <div class="top">
    <app-inline-name-edit
      *ngIf="renaming$ | async; else toolbar"
      [name]="name"
      (cancel)="finishRename$.next()"
      (save)="onRename($event)"
    ></app-inline-name-edit>
    <ng-template #toolbar>
      <a routerLink="/planner/{{ id }}">
        <h3>
          {{ name }}
        </h3>
      </a>
      <button app-button
        buttonStyle="ternary"
        [icon]="faEllipsisV"
        [appOptionsMenuTrigger]="optionsMenu"
      ></button>
      <app-options-menu #optionsMenu>
        <li app-options-menu-item
          (click)="onPrint()"
        >
          Print
        </li>
        <li app-options-menu-item
          (click)="startRename$.next()"
        >
          Rename
        </li>
        <a app-options-menu-item
          routerLink="/planner/{{ id }}"
        >
          Edit Dishes
        </a>
        <li app-options-menu-item
          [disabled]="!canDelete"
          (click)="onDelete()"
        >
          Delete
        </li>
      </app-options-menu>
    </ng-template>
  </div>
  <ul>
    <li class="entry"
      *ngFor="let entry of entries; trackBy: entriesTrackByFn"
    >
      <app-small-caps-label class="day">
        <h4>
          {{ entry.day | slice : 0 : 3 }}
        </h4>
      </app-small-caps-label>
      <div class="container">
        <app-dish-summary
          [id]="entry.main?.id"
          [name]="entry.main?.name"
        ></app-dish-summary>
        <ul *ngIf="entry.sides.length"
          class="sides"
          >
          <p>&nbsp;+&nbsp;</p>
          <ng-container *ngFor="let side of entry.sides; trackBy: dishesTrackByFn; let last = last">
            <app-dish-summary
              [id]="side.id"
              [name]="side.name"
            ></app-dish-summary>
            <span *ngIf="!last">,&nbsp;</span>
          </ng-container>
        </ul>
      </div>
    </li>
  </ul>
</app-card>
