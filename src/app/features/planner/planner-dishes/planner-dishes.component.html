<app-section *ngIf="vm$ | async as vm">
  <div class="app-section__toolbar">
    <div class="controls">
      <h2 class="title">
        Dishes ({{ vm.total }})
      </h2>
      <app-search-input
        [text]="vm.searchText"
        (textChange)="onSearchTextChange($event)"
      ></app-search-input>
      <button app-button
        buttonStyle="secondary"
        (click)="toggleFilterPanel(vm.filterPanel)"
      >
        Filter
      </button>
      <app-options-menu #optionsMenu>
        Stuff will go here
      </app-options-menu>
      <a app-button
        routerLink="/dishes/new"
      >
        New Dish
      </a>
    </div>
    <app-card *ngIf="vm.filterPanel"
      class="filter-panel"
    >
      <ul class="filter-panel__tags">
        <li *ngFor="let tag of vm.tags; trackBy: tagTrackByFn"
          class="filter-panel__tag"
        >
          <app-checkbox
            [name]="tag.id"
            [ngModel]="false"
          >
            <app-tag
              [id]="tag.id"
              [name]="tag.name"
            ></app-tag>
          </app-checkbox>
        </li>
      </ul>
    </app-card>
  </div>
  <ul class="app-section__content">
    <app-tabset contentVisibility="visible">
      <app-tab name="Mains ({{ vm.mains.length }})">
        <ul *ngIf="vm.mains.length; else noMainsPlaceholder">
          <li app-planner-dish
            *ngFor="let main of vm.mains; trackBy: dishTrackByFn"
            [id]="main.id"
            [type]="main.type"
            [name]="main.name"
            [description]="main.description"
            [link]="main.link"
            [tags]="main.tags"
            [menus]="main.menus"
            [usages]="main.usages"
            [menu]="vm.menu"
            (dayChange)="onDayChange(vm.menu, $event)"
          ></li>
        </ul>
        <ng-template #noMainsPlaceholder>
          <div class="placeholder">
            No main dishes to display
          </div>
        </ng-template>
      </app-tab>
      <app-tab name="Sides ({{ vm.sides.length }})">
        <ul *ngIf="vm.sides.length; else noSidesPlaceholder">
          <li app-planner-dish
            *ngFor="let side of vm.sides; trackBy: dishTrackByFn"
            [id]="side.id"
            [type]="side.type"
            [name]="side.name"
            [description]="side.description"
            [link]="side.link"
            [tags]="side.tags"
            [menus]="side.menus"
            [usages]="side.usages"
            [menu]="vm.menu"
            (dayChange)="onDayChange(vm.menu, $event)"
          ></li>
        </ul>
        <ng-template #noSidesPlaceholder>
          <div class="placeholder">
            No side dishes to display
          </div>
        </ng-template>
      </app-tab>
    </app-tabset>
  </ul>
</app-section>
